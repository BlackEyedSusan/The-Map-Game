{% extends "base.html" %} {% block title %}Draft{% endblock %}
{% block content %}
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <h2>Drafting: Round {{game.ticker}}</h2>
    {% if is_turn %}
        <form method="POST">
            <input name="draft" type="text" id="draft"/>
            <input type="submit" class="main-button" id="draft_button" value="Draft" onclick="draft();"/>
        </form>
    {% else %}
        <h4>Wait patiently for your turn please!</h4>
    {% endif %}
    <h3>Valid Draft Picks:</h3>
    {% for territory in valid_claims %}
        <h4>{{territory.name}}</h4>
    {% endfor %}
    <h3>Your Drafted Territories:</h3>
    {% for territory in territory_list %}
        {% if territory.owner == current_empire.id %}
            <h4>{{territory.name}}</h4>
        {% endif %}
    {% endfor %}
    <h3>Other Drafted Territories:</h3>
    {% for territory in territory_list %}
        {% if territory.owner != current_empire.id and territory.owner != 0 %}
            <h4>{{territory.name}}</h4>
        {% endif %}
    {% endfor %}
    <input type="hidden" id=game value="{{game.id}}"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8">
        var socket = io();
        var game_id = document.getElementById("game").value;
        /*socket.on('connect', function() {
            socket.emit('draft', {data: game_id});
        });*/
        
        function draft() {
            console.log(game_id)
            socket.emit('draft', {"data": game_id})
        }
    </script>
{% endblock %}